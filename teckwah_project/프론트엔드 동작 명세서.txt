# 배송 실시간 관제 시스템 프론트엔드 동작 명세서

## 1. 시스템 개요

본 시스템은 물류/배송 관리를 위한 실시간 관제 대시보드 웹 애플리케이션으로, Dash 프레임워크 기반의 프론트엔드와 FastAPI 기반의 백엔드로 구성됩니다. 주요 기능으로 배송 주문 관리, 배차 처리, 데이터 시각화, 그리고 데이터 다운로드 기능을 제공합니다.

## 2. 페이지 구조

### 2.1 로그인 페이지
- 시스템 로고 및 타이틀 표시
- 사용자 ID, 비밀번호 입력 폼
- 로그인 버튼 및 오류 메시지 표시 영역

### 2.2 대시보드 페이지
- 헤더 영역 (타이틀 및 설명)
- 기간 선택 필터 (ETA 기준)
- 주문번호 검색 기능
- 액션 버튼 영역 (신규 등록, 배차, 삭제, 새로고침)
- 필터 영역 (종류, 부서, 출발 허브)
- 배송 목록 테이블 영역
  - 체크박스 선택 열
  - 주문 정보 표시 (주문번호, 종류, 상태, 부서 등)
  - 상태별 색상 구분

### 2.3 시각화 페이지
- 헤더 영역 (타이틀 및 설명)
- 차트 타입 선택기 (배송 현황, 시간대별 접수량)
- 기간 선택 필터
- 새로고침 버튼
- 배송 현황 차트 컨테이너
  - 통계 카드 (총 배송 건수, 대기 중 건수, 완료 건수)
  - 배송 상태별 비율 파이 차트
  - 부서별 배송 상태 바 차트
- 시간대별 접수량 차트 컨테이너
  - 통계 카드 (총 접수 건수, 일평균 접수 건수, 피크 시간대)
  - 시간대별 접수량 라인 차트
  - 부서별 시간대 접수량 히트맵

### 2.4 다운로드 페이지 (관리자 전용)
- 헤더 영역 (타이틀 및 설명)
- 다운로드 설정 카드
  - 조회 기간 선택
  - 다운로드 가능 기간 정보
  - Excel 다운로드 버튼
- 관리자 권한 확인 영역
- 로딩 스피너

## 3. 컴포넌트

### 3.1 네비게이션 바
- 로고 및 시스템 이름
- 네비게이션 메뉴 (대시보드, 시각화, 다운로드)
- 세션 확인 및 토큰 갱신 버튼
- 사용자 정보 및 로그아웃 버튼

### 3.2 대시보드 상세 정보 모달
- 주문 기본 정보 탭
  - 주문 정보 (주문번호, 종류, 상태, 부서, 창고, SLA)
  - 시간 정보 (ETA, 생성시간, 출발시간, 완료시간)
  - 고객 정보 (고객명, 연락처, 우편번호, 지역, 주소)
  - 배송 정보 (거리, 소요시간, 기사명, 기사연락처)
  - 메모 영역
  - 상태 변경 버튼 (대기, 진행 중, 완료, 이슈, 취소)
- 정보 편집 탭
  - 각 필드 편집 폼
  - 유효성 검증 피드백
  - 저장 버튼

### 3.3 배차 모달
- 기사명 입력 필드
- 연락처 입력 필드
- 선택된 주문 정보
- 취소 및 배차 완료 버튼

### 3.4 삭제 확인 모달
- 삭제 확인 메시지
- 선택된 주문 정보
- 취소 및 삭제 버튼

### 3.5 신규 등록 모달
- 주문 정보 입력 폼 (주문번호, 종류, 창고, SLA, ETA)
- 고객 정보 입력 폼 (고객명, 연락처, 우편번호, 주소)
- 취소 및 등록 버튼

### 3.6 알림 컴포넌트
- 알림 메시지
- 알림 색상 (primary, success, warning, danger)
- 자동 사라짐 타이머

## 4. 데이터 상태 관리

### 4.1 인증 상태 (auth-store)
- access_token: 액세스 토큰
- refresh_token: 리프레시 토큰
- is_authenticated: 인증 여부
- auth_time: 인증 시간

### 4.2 사용자 정보 (user-info-store)
- user_id: 사용자 ID
- department: 부서
- role: 역할
- is_admin: 관리자 여부

### 4.3 앱 전역 상태 (app-state-store)
- alert: 알림 정보
- modals: 모달 상태 정보
- filters: 필터 상태

## 5. API 호출

### 5.1 인증 관련
- login(user_id, password): 로그인
- logout(refresh_token, access_token): 로그아웃
- refresh_token(refresh_token): 토큰 갱신
- check_session(access_token): 세션 유효성 확인

### 5.2 대시보드 관련
- get_dashboard_list(start_date, end_date, access_token): 대시보드 목록 조회
- get_dashboard_detail(dashboard_id, access_token): 대시보드 상세 조회
- update_dashboard_status(dashboard_id, status, is_admin, access_token): 상태 업데이트
- update_dashboard_fields(dashboard_id, fields, access_token): 필드 업데이트
- create_dashboard(dashboard_data, access_token): 대시보드 생성
- assign_driver(dashboard_ids, driver_name, driver_contact, access_token): 배차 처리
- delete_dashboards(dashboard_ids, access_token): 대시보드 삭제
- search_by_order_no(order_no, access_token): 주문번호로 검색

### 5.3 락 관련
- acquire_lock(dashboard_id, lock_type, access_token): 락 획득
- release_lock(dashboard_id, access_token): 락 해제

### 5.4 메모 관련
- update_remark(dashboard_id, remark_id, content, access_token): 메모 업데이트

### 5.5 시각화 관련
- get_delivery_status(start_date, end_date, access_token): 배송 현황 데이터 조회
- get_hourly_orders(start_date, end_date, access_token): 시간대별 접수량 데이터 조회
- get_visualization_date_range(access_token): 시각화 가능 날짜 범위 조회

### 5.6 다운로드 관련
- get_download_date_range(access_token): 다운로드 가능 날짜 범위 조회
- download_excel(start_date, end_date, access_token): Excel 다운로드

## 6. 주요 기능 및 서비스 로직

### 6.1 인증 관리
- 로그인 처리 및 토큰 저장
- 세션 만료 확인 및 토큰 갱신
- 권한 기반 접근 제어 (관리자/일반 사용자)
- 로그아웃 처리

### 6.2 대시보드 관리
- 날짜 범위 기반 데이터 로드
- 필터링 (종류, 부서, 창고)
- 주문번호 검색
- 상세 정보 조회 및 편집
- 상태 변경 (대기, 진행 중, 완료, 이슈, 취소)
- 메모 관리
- 필드 유효성 검증
- 신규 배송 등록
- 다중 선택 배차 처리
- 다중 선택 삭제 (관리자만)

### 6.3 비관적 락 관리
- 편집 시 락 획득
- 다른 사용자의 동시 편집 방지
- 락 해제 (작업 완료 또는 취소 시)
- 락 상태 확인 및 메시지 표시

### 6.4 데이터 시각화
- 차트 타입 기반 컨테이너 전환
- 날짜 범위 기반 데이터 로드
- 배송 현황 차트 생성 (파이 차트, 바 차트)
- 시간대별 접수량 차트 생성 (라인 차트, 히트맵)
- 통계 정보 표시

### 6.5 데이터 다운로드 (관리자 전용)
- 관리자 권한 확인
- 날짜 범위 기반 Excel 파일 다운로드
- 다운로드 가능 날짜 범위 조회

## 7. UX 상호작용 및 알림

### 7.1 로딩 상태 관리
- 데이터 로드 중 로딩 스피너 표시
- 로드 완료 시 데이터 표시 또는 빈 데이터 메시지 표시

### 7.2 알림 관리
- 작업 성공/실패 시 적절한 알림 메시지 표시
- 알림 색상을 통한 상태 구분 (success, warning, danger 등)
- 자동 사라짐 타이머 설정

### 7.3 테이블 상호작용
- 행 선택 (체크박스)을 통한 다중 선택
- 행 클릭을 통한 상세 정보 모달 열기
- 선택 행에 따른 버튼 활성화/비활성화

### 7.4 모달 상호작용
- 모달 열기/닫기
- 편집 가능 여부 (락 상태에 따름)
- 필드 유효성 검증 피드백
- 저장/취소 버튼

### 7.5 필터 상호작용
- 날짜 범위 선택
- 드롭다운 필터 선택 (종류, 부서, 창고)
- 필터 적용 및 초기화

### 7.6 세션 관리
- 세션 만료 확인
- 토큰 갱신 알림
- 인증 필요 시 로그인 페이지로 리다이렉트

## 8. 백엔드 연동 고려사항

### 8.1 API 응답 형식
- success: 성공 여부 (boolean)
- message: 메시지 (string)
- data: 데이터 객체
- 특수 상태 (need_login, is_locked 등)

### 8.2 오류 처리
- 서버 연결 오류 처리
- 인증 오류 처리 (401)
- 락 충돌 오류 처리 (423)
- 일반 오류 처리

### 8.3 락 관리 협업
- 비관적 락 획득/해제 요청
- 락 정보 표시 (사용자명, 락 타입, 만료 시간)
- 충돌 시 사용자 친화적 메시지 표시

### 8.4 권한 관리
- 관리자/일반 사용자 구분
- 권한 기반 기능 접근 제어
- 권한 부족 메시지 표시

# 9. 기타내용
## 9.1 assets 폴더의 내용
- teckwah_project/dash/assets/ 안에는 logo.png와 favicorn.ico가 존재함