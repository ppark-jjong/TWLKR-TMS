배송 실시간 관제 시스템 – 프로젝트 요구사항 프롬프트

1. 프로젝트 개요
   목표: 실시간 배송 현황을 모니터링하고 관리하는 시스템 구축
   주요 기능: 사용자 인증, 대시보드 관리(조회, 생성, 상태 변경, 삭제), 데이터 시각화, 데이터 자동 처리, 데이터 이관
   최종 산출물: 사용자와 관리자가 각기 다른 권한으로 접근할 수 있는 웹 애플리케이션 (SPA) 및 RESTful API 서버
2. 시스템 아키텍처 및 기술 스택
   2.1 프론트엔드
   프레임워크: React.js (v18.2.0, 순수 JavaScript)
   상태 관리: React Context API
   라우팅: React Router (v6.15.0)
   UI 라이브러리: Ant Design (v5.9.0)
   HTTP 클라이언트: Axios (v1.5.0)
   Axios 인터셉터를 통해 네트워크/서버/인증 에러 및 토큰 갱신 처리
   날짜 처리: Day.js (v1.11.9)
   빌드: Create React App 기본 설정 (추가 라이브러리 최소화)
   2.2 백엔드
   프레임워크: FastAPI (Python)
   ORM: SQLAlchemy
   데이터 검증: Pydantic
   데이터베이스: MySQL
   주요 테이블:
   dashboard: 배송 대시보드 메인 정보
   user: 사용자 인증 정보 (비밀번호는 bcrypt로 해싱)
   postal_code: 우편번호 기반 지역 정보
   postal_code_detail: 각 허브별 거리/소요시간 정보
   refresh_token: 토큰 관리
   (참고: 기존 error_log 테이블은 제거됨)
   인증: JWT 기반 (Access Token: 60분, Refresh Token: 7일)
   데이터 분석: Pandas (시각화 API에서 데이터 집계)
   API 문서화: Swagger/OpenAPI 자동 생성 (FastAPI 내장)
3. 데이터베이스 및 인덱싱 전략
   테이블 설계:
   dashboard: 주문번호, 배송 타입, 출발 허브, SLA, ETA, 우편번호, 주소, 수령인, 연락처, 상태, 배차 정보, 생성일자 등
   user: 사용자 ID, 해시 처리된 비밀번호, 역할 (ADMIN/USER), 기타 메타데이터
   postal_code: 우편번호, 도시, 군/구, 지역
   postal_code_detail: 허브별 (SEOUL, BUSAN, GWANGJU, DAEJEON) 거리 및 소요시간 정보
   refresh_token: 사용자별 토큰 값 및 만료 정보
   인덱스 대상: ETA, 생성일자, 상태, 부서 등 조회/정렬에 빈번히 사용되는 컬럼
4. 인증 시스템 (AuthService)
   4.1 로그인 API – /auth/login
   서비스 로직:
   입력 검증: 사용자 ID(공백 불가), 비밀번호(최소 4자 이상)
   사용자 인증:
   사용자 ID로 데이터베이스 조회
   bcrypt로 비밀번호 해시 비교
   토큰 생성:
   Access Token (60분 유효)
   Refresh Token (7일 유효)
   Refresh Token 저장: DB에 저장 후 사용자 정보와 함께 토큰 응답
   주요 메서드: authenticate_user(login_data)
   4.2 토큰 갱신 API – /auth/refresh
   서비스 로직:
   리프레시 토큰 검증: 기존 토큰 유효성 검사 후
   토큰 갱신: 기존 토큰 무효화, 새 Access Token 발급 (필요 시 새로운 Refresh Token도 선택적 발급)
   주요 메서드: refresh_token(refresh_token)
   4.3 로그아웃 API – /auth/logout
   서비스 로직:
   클라이언트로부터 전달받은 Refresh Token 무효화 (DB 삭제)
   클라이언트 측 토큰 삭제 응답
5. 대시보드 관리 시스템 (DashboardService)
   5.1 대시보드 목록 조회 API – /dashboard/list
   서비스 로직:
   날짜 기반 조회:
   일반 사용자는 단일 날짜(YYYY-MM-DD) 조회
   관리자는 날짜 범위(시작일, 종료일)를 통한 조회 지원
   데이터 최적화: 입력 날짜 검증, 인덱스 활용한 최적 쿼리, 조회 가능한 날짜 범위 정보 제공
   주요 메서드: get_dashboard_list(date)
   5.2 대시보드 생성 API – /dashboard
   서비스 로직:
   데이터 유효성 검사: 주문번호, 배송 타입, 출발 허브, SLA, ETA(현재 시간 이후), 우편번호(5자리 숫자), 주소, 수령인, 연락처
   자동 처리:
   우편번호 기반 자동 완성 (도시, 군/구, 지역 추출)
   출발 허브 기준 거리 및 소요시간 계산 (데이터 없으면 기본값: 거리=0, 소요시간="")
   데이터베이스 저장: 성공 시 생성된 대시보드 정보 응답
   주요 메서드: create_dashboard(dashboard_data)
   5.3 대시보드 상태 변경 API – /dashboard/{id}/status
   서비스 로직:
   상태 검증:
   현재 상태에 따른 변경 가능 여부 확인
   예:
   WAITING: IN_PROGRESS 또는 CANCEL (변경 시 배차 정보 필수)
   IN_PROGRESS: COMPLETE, ISSUE 또는 CANCEL
   COMPLETE/ISSUE/CANCEL: 추가 변경 불가
   관리자 권한: 관리자는 조건과 상관없이 상태 변경 가능하되, 반드시 확인 모달(클라이언트 측) 동작 요구
   업데이트: 상태 변경 시 관련 시간 정보 업데이트 및 DB 저장 후 변경된 정보 응답
   주요 메서드: update_status(dashboard_id, status_update)
   5.4 대시보드 삭제 API – /dashboard
   서비스 로직:
   삭제 권한:
   관리자: 모든 상태의 대시보드 삭제 가능 (다중 행 선택 지원)
   일반 사용자: WAITING 상태의 대시보드만 삭제 가능
   삭제 처리: 대상 대시보드 필터링, DB에서 삭제, 결과 응답
   주요 메서드: delete_dashboards(dashboard_ids)
6. 데이터 시각화 시스템 (VisualizationService)
   6.1 배송 현황 차트 API – /visualization/delivery_status
   서비스 로직:
   데이터 집계:
   날짜 범위 내 데이터 조회
   Pandas를 활용하여 부서별(예: CS, HES, LENOVO) 각 상태( WAITING, IN_PROGRESS, COMPLETE, ISSUE, CANCEL)의 건수 및 비율 집계
   응답 데이터: 시각화에 적합한 데이터 구조 생성
   주요 메서드: get_delivery_status(start_date, end_date)
   6.2 시간대별 접수량 API – /visualization/hourly_orders
   서비스 로직:
   데이터 집계:
   날짜 범위 내 데이터 조회
   Pandas를 활용하여 주간(08:0022:00, 1시간 단위)과 야간(22:0008:00, 통합 집계) 별 접수량 분석
   부서별 접수량 및 평균, 총계 산출
   응답 데이터: 차트 생성용 데이터 구조 반환
   주요 메서드: get_hourly_orders(start_date, end_date)
7. 데이터 이관 로직
   7.1 마이그레이션 서비스
   서비스 로직:
   매월 말 자동으로 실행되는 데이터 이관 작업
   데이터 분류:
   핫 데이터: 최근 1개월
   콜드 데이터: 1개월 이상 경과
   처리:
   분리된 데이터를 오브젝트 스토리지에 적재
   최소 1년 이상 보존 정책 적용
8. 프론트엔드 – 페이지별 상세 기능 명세
   8.1 로그인 페이지 (LoginPage)
   입력 폼:
   ID (필수, 공백 불가)
   비밀번호 (필수, 최소 4자 이상, 선택적 특수문자/숫자 포함 검증)
   실시간 CSR 검증:
   입력 즉시 유효성 체크 및 에러 메시지 표시
   상호작용:
   로그인 버튼 활성/비활성 동적 제어
   API 호출 시 로딩 인디케이터 표시
   인증 실패/네트워크 에러 시 즉각적인 오류 피드백
   8.2 대시보드 페이지 (DashboardPage)
   공통 구성 요소:
   날짜 선택 컴포넌트:
   일반 사용자: 단일 날짜(YYYY-MM-DD) 선택
   관리자: 기간(시작일, 종료일) 선택 가능
   조회 가능한 날짜 범위 및 현재 데이터 보유 기간 안내
   대시보드 테이블:
   데이터 컬럼: 체크박스, 종류, 부서, 출발 허브, 배송 담당, 주문번호, 상태, ETA
   기능:
   부서, 상태, 배송 타입 필터링
   생성일자, ETA, 주문번호 정렬
   페이지네이션 (50건/페이지)
   액션 버튼:
   대시보드 생성, 배차, 새로고침
   관리자 전용: 선택된 행 다중 삭제 (삭제 전 확인 모달 필수)
   8.3 대시보드 생성 모달 (CreateDashboardModal)
   입력 폼 필드:
   주문번호 (정수)
   배송 타입 (DELIVERY/RETURN)
   출발 허브 (SEOUL/BUSAN/GWANGJU/DAEJEON)
   SLA (10자 이내)
   ETA (현재 시간 이후의 미래 시간만 선택)
   우편번호 (5자리 숫자)
   주소
   수령인 정보
   연락처 (형식: 01x-xxx-xxxx)
   CSR 검증:
   실시간 유효성 검사 및 오류 피드백
   우편번호 입력 시 지역 정보(도시, 군/구, 지역) 자동 완성
   연락처 입력 시 하이픈 자동 추가, 숫자만 입력 가능
   생성 버튼: 모든 필드 유효 시 활성화
   8.4 대시보드 상세 모달 (DashboardDetailModal)
   정보 표시:
   기본 배송 정보, 상태, 배차 정보, 주소 등
   상태 변경 섹션:
   현재 상태에 따른 변경 가능 옵션 제공
   상태 변경 시 확인 모달을 통해 재확인 처리 (관리자/일반 모두 적용; 단, 관리자는 모든 상태 변경 가능)
   메모 수정:
   메모 입력 시 글자 수 제한 및 (특수문자 허용/제한 옵션에 따른) 처리
   8.5 관리자 대시보드 페이지 (AdminPage)
   특화 기능:
   일반 대시보드와 동일한 기본 기능(테이블, 필터, 정렬, 배차)
   추가 기능:
   상태 변경: 조건 없이 변경 가능하되, 변경 전 반드시 확인 모달 표시
   삭제 기능: 선택된 대시보드 행(하나 이상) 다중 삭제 지원 (삭제 전 확인 모달 필수)
   날짜 조회: 날짜 범위(시작일, 종료일) 지정 가능
   8.6 시각화 페이지 (VisualizationPage)
   차트 기능:
   배송 현황 차트: 부서별(예: CS, HES, LENOVO) 각 상태( WAITING, IN_PROGRESS, COMPLETE, ISSUE, CANCEL) 분포 집계
   시간대별 접수량 차트:
   주간(08:00~22:00): 1시간 단위 집계
   야간(22:00~08:00): 통합 집계
   상호작용:
   차트에 마우스 호버 및 클릭 시 추가 상세 정보 표시
   날짜 범위 선택 및 부서/상태별 필터링
   8.7 공통 CSR 검증 및 에러 처리
   폼 검증 원칙:
   모든 입력 필드에 대해 실시간 유효성 검사, 즉각적인 피드백 및 사용자 친화적 에러 메시지 제공
   에러 처리:
   Axios 인터셉터로 네트워크, 서버, 인증 에러 감지 및 토큰 만료 시 로그인 페이지로 리다이렉트
9. 공통 서비스 로직 및 에러 처리
   9.1 데이터 범위 조회
   기능:
   조회 가능한 최초 및 최신 날짜 정보 제공
   DB 쿼리 최적화를 통해 기본값 설정(데이터가 없을 경우)
   9.2 에러 처리
   전략:
   명확한 에러 메시지 생성 및 HTTP 상태 코드(400, 401, 403, 404, 500) 적절 사용
   로깅 시스템 연동 (error_log 테이블 대신 외부 파일 로그 또는 모니터링 도구 활용)
10. 추가 구현 고려사항 및 개발 프로세스
    10.1 보안
    인증/인가:
    JWT 토큰 서명, 만료, 무결성 검사
    bcrypt로 비밀번호 안전하게 해싱
    역할 기반 접근 제어 (ADMIN/USER)
    데이터 보호:
    민감 정보 암호화
    최소 권한 원칙 적용
    안전한 토큰 저장
    10.2 테스트 및 문서화
    테스트:
    단위 테스트, 통합 테스트 케이스 작성 (예: 로그인, 대시보드 CRUD, 상태 변경, 시각화, 데이터 자동 처리)
    문서화:
    Swagger/OpenAPI 문서 자동 생성
    각 API, 서비스 로직, 페이지 컴포넌트에 대한 주석 및 개발 가이드 제공
    10.3 성능 최적화 및 배포
    성능 최적화:
    DB 인덱싱, 효율적인 JOIN 및 페이징, 배치 처리
    캐싱 전략 고려
    배포:
    프론트엔드와 백엔드 각각 CI/CD 파이프라인 구성
    환경 변수 관리 및 모니터링 시스템 연동
11. 최종 요약
    이 프롬프트는 배송 실시간 관제 시스템을 바로 서비스 가능한 웹 프로젝트로 구축하기 위한 종합 요구사항입니다.

프론트엔드: React 기반 SPA로 사용자 및 관리자 페이지(로그인, 대시보드, 모달, 시각화) 구현
백엔드: FastAPI 기반 RESTful API로 인증, 대시보드 관리, 데이터 시각화, 토큰 갱신 및 로그아웃 등 모든 기능 구현
데이터베이스: MySQL을 사용하며, 데이터 자동 처리 및 이관 전략 포함
보안 및 성능: JWT, bcrypt, 인덱싱, 쿼리 최적화, 에러 처리 등 확실히 반영
개발 프로세스: 모듈화, 주석 및 문서화, 테스트, CI/CD 파이프라인 구성
개발자는 이 요구사항 프롬프트를 기반으로 코드 구조, 서비스 로직, UI/UX, 보안 및 성능 최적화에 관한 모든 세부 사항을 구현하여, 곧바로 실제 운영 가능한 시스템을 구축할 수 있습니다.
