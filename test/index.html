<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TeckwahTMS - 배송 관리 시스템</title>
  
  <!-- 파비콘 -->
  <link rel="icon" href="assets/favicon.ico" type="image/x-icon">
  <link rel="shortcut icon" href="assets/favicon.ico" type="image/x-icon">
  
  <!-- Ant Design CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/antd@5.11.0/dist/reset.css">
  
  <!-- 사용자 정의 CSS -->
  <link rel="stylesheet" href="styles/styles.css">
  
  <!-- 폰트 어썸 -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
</head>
<body>
  <div id="app" class="app">
    <!-- 레이아웃 -->
    <div class="main-layout">
      <!-- 사이드바 -->
      <aside id="sidebar" class="sidebar">
        <div class="logo-container">
          <h1>TWLKR-TMS</h1>
        </div>
        
        <div class="user-info">
          <div class="avatar">
            <i class="fa-solid fa-user"></i>
          </div>
          <div class="user-details">
            <p class="user-name">CSAdmin</p>
            <p class="user-role">CS</p>
          </div>
        </div>
        
        <nav class="menu">
          <ul>
            <li class="menu-item active" data-page="dashboard">
              <i class="fa-solid fa-chart-line"></i>
              <span>TMS</span>
            </li>
            <li class="menu-item" data-page="handover">
              <i class="fa-solid fa-right-left"></i>
              <span>인수인계</span>
            </li>
            <li class="menu-item" data-page="visualization">
              <i class="fa-solid fa-chart-bar"></i>
              <span>visualization</span>
            </li>
          </ul>
        </nav>
        
        <div class="logout-container">
          <button id="logoutBtn" class="logout-btn">
            <i class="fa-solid fa-right-from-bracket"></i>
            <span>로그아웃</span>
          </button>
        </div>
      </aside>
      
      <!-- 메인 컨텐츠 -->
      <main class="main-content">

        
        <!-- 컨텐츠 영역 -->
        <div class="content-container">
          <!-- 대시보드 페이지 -->
          <div class="page-section" id="dashboardPage">
            <!-- 요약 카드 영역 -->
            <div class="summary-cards">
              <div class="summary-card">
                <div class="summary-icon bg-blue">
                  <i class="fa-solid fa-boxes-stacked"></i>
                </div>
                <div class="summary-data">
                  <p class="summary-label">총 배송 건수</p>
                  <h3 class="summary-value" id="totalOrders">0건</h3>
                </div>
              </div>
              
              <div class="summary-card">
                <div class="summary-icon bg-orange">
                  <i class="fa-solid fa-truck-fast"></i>
                </div>
                <div class="summary-data">
                  <p class="summary-label">진행 중 배송</p>
                  <h3 class="summary-value" id="inProgressOrders">0건</h3>
                </div>
              </div>
              
              <div class="summary-card">
                <div class="summary-icon bg-green">
                  <i class="fa-solid fa-check-circle"></i>
                </div>
                <div class="summary-data">
                  <p class="summary-label">완료된 배송</p>
                  <h3 class="summary-value" id="completedOrders">0건</h3>
                </div>
              </div>
            </div>
            
            <!-- 메인 대시보드 카드 -->
            <div class="main-card">
              <div class="card-header">
                <h2>배송 관리</h2>
                
                <div class="card-actions">
                  <button class="btn primary-btn" id="refreshBtn">
                    <i class="fa-solid fa-arrows-rotate"></i> 새로고침
                  </button>
                  <button class="btn primary-btn" id="assignBtn">
                    <i class="fa-solid fa-truck"></i> 배차 처리
                  </button>
                  <button class="btn primary-btn" id="newOrderBtn">
                    <i class="fa-solid fa-plus"></i> 신규 등록
                  </button>
                  <button class="btn danger-btn" id="deleteOrderBtn">
                    <i class="fa-solid fa-trash"></i> 삭제
                  </button>
                </div>
              </div>
              
              <!-- 통합 검색 및 필터 영역 -->
              <div class="control-panel">
                <!-- 날짜 필터 영역 -->
                <div class="date-filter-section">
                  <div class="section-title">기간 (생성 일자 기준)</div>
                  <div class="daterange-picker">
                    <input type="date" id="startDate" class="date-input">
                    <span class="date-separator">~</span>
                    <input type="date" id="endDate" class="date-input">
                    <span class="date-label" id="dateRangeLabel"></span>
                  </div>
                </div>
                
                <!-- 검색 영역 -->
                <div class="search-section">
                  <div class="search-container">
                    <input type="text" id="searchKeyword" class="search-input" placeholder="주문번호">
                    <button class="search-button" id="searchBtn">
                      <i class="fa-solid fa-search"></i>
                    </button>
                  </div>
                </div>
                
                <!-- 필터 영역 -->
                <div class="filter-section">
                  <div class="filter-container">
                    <div class="filter-item">
                      <label for="statusFilter">상태</label>
                      <select id="statusFilter" class="filter-select">
                        <option value="">전체</option>
                        <option value="PENDING">대기</option>
                        <option value="IN_PROGRESS">진행</option>
                        <option value="COMPLETE">완료</option>
                        <option value="ISSUE">이슈</option>
                        <option value="CANCEL">취소</option>
                      </select>
                    </div>
                    
                    <div class="filter-item">
                      <label for="departmentFilter">부서</label>
                      <select id="departmentFilter" class="filter-select">
                        <option value="">전체</option>
                      </select>
                    </div>
                    
                    <div class="filter-item">
                      <label for="warehouseFilter">창고</label>
                      <select id="warehouseFilter" class="filter-select">
                        <option value="">전체</option>
                      </select>
                    </div>
                    
                    <div class="filter-actions">
                      <button class="btn secondary-btn" id="resetBtn">
                        <i class="fa-solid fa-rotate-left"></i> 초기화
                      </button>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- 데이터 테이블 -->
              <div class="table-container">
                <table class="data-table" id="dashboardTable">
                  <thead>
                    <tr>
                      <th class="checkbox-cell">
                        <input type="checkbox" id="selectAll">
                      </th>
                      <th>주문번호</th>
                      <th>고객</th>
                      <th>유형</th>
                      <th>상태</th>
                      <th>부서</th>
                      <th>창고</th>
                      <th>ETA</th>
                      <th>배송기사</th>

                    </tr>
                  </thead>
                  <tbody id="dashboardTableBody">
                    <tr>
                      <td colspan="10" class="empty-table">데이터를 불러오는 중...</td>
                    </tr>
                  </tbody>
                </table>
              </div>
              
              <!-- 페이지네이션 -->
              <div class="pagination" id="pagination">
                <button class="page-btn" data-page="prev">
                  <i class="fa-solid fa-chevron-left"></i>
                </button>
                <span class="page-info" id="pageInfo">1 / 1</span>
                <button class="page-btn" data-page="next">
                  <i class="fa-solid fa-chevron-right"></i>
                </button>
                
                <div class="page-size">
                  <span>표시 행 수:</span>
                  <select id="pageSize" class="select-field">
                    <option value="5">5행</option>
                    <option value="10" selected>10행</option>
                    <option value="15">15행</option>
                  </select>
                </div>
              </div>
            </div>
          </div>
          
          <!-- 시각화 페이지 -->
          <div class="page-section" id="visualizationPage" style="display: none;">
            <div class="main-card">
              <div class="card-header">
                <h2>배송 데이터 시각화</h2>
                <div class="card-actions">
                  <button class="btn primary-btn" id="refreshVisualizationBtn">
                    <i class="fa-solid fa-arrows-rotate"></i> 새로고침
                  </button>
                </div>
              </div>
              
              <!-- 시각화 컨트롤 패널 -->
              <div class="control-panel">
                <!-- 날짜 필터 영역 -->
                <div class="date-filter-section">
                  <div class="section-title">기간 (ETA 기준)</div>
                  <div class="daterange-picker">
                    <input type="date" id="vizStartDate" class="date-input">
                    <span class="date-separator">~</span>
                    <input type="date" id="vizEndDate" class="date-input">
                    <span class="date-label" id="vizDateRangeLabel"></span>
                  </div>
                </div>
                
                <!-- 필터 영역 -->
                <div class="filter-section">
                  <div class="filter-container">
                    <div class="filter-item">
                      <label for="vizChartType">시각화 유형</label>
                      <select id="vizChartType" class="filter-select">
                        <option value="time">시간대별 주문 접수</option>
                        <option value="dept-status">부서별 배송 상태 분포</option>
                      </select>
                    </div>
                    <div class="filter-item">
                      <label for="vizDepartmentFilter">부서</label>
                      <select id="vizDepartmentFilter" class="filter-select">
                        <option value="">전체</option>
                        <option value="CS">CS</option>
                        <option value="HES">HES</option>
                        <option value="LENOVO">LENOVO</option>
                      </select>
                    </div>
                    
                    <div class="filter-actions">
                      <button class="btn primary-btn" id="applyVizFilterBtn">
                        <i class="fa-solid fa-filter"></i> 필터 적용
                      </button>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- 차트 영역 -->
              <div class="chart-container" id="mainChartContainer">
                <canvas id="orderTimeChart"></canvas>
              </div>
              
              <!-- 부서별 차트 컨테이너 -->
              <div class="department-charts" id="departmentChartsContainer" style="display: none;">
                <div class="department-chart-row">
                  <div class="department-chart">
                    <h4>CS 부서</h4>
                    <div class="chart-container">
                      <canvas id="csChart"></canvas>
                    </div>
                  </div>
                  <div class="department-chart">
                    <h4>HES 부서</h4>
                    <div class="chart-container">
                      <canvas id="hesChart"></canvas>
                    </div>
                  </div>
                </div>
                <div class="department-chart-row">
                  <div class="department-chart">
                    <h4>LENOVO 부서</h4>
                    <div class="chart-container">
                      <canvas id="lenovoChart"></canvas>
                    </div>
                  </div>
                  <div class="department-chart">
                    <h4>전체 부서 비교</h4>
                    <div class="chart-container">
                      <canvas id="allDeptChart"></canvas>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- 차트 영역만 유지하고 데이터 요약 섹션 제거함 -->
            </div>
          </div>
          
          <!-- 인수인계 페이지 -->
          <div class="page-section" id="handoverPage" style="display: none;">
            <div class="main-card">
              <div class="card-header">
                <h2>인수인계 목록</h2>
                <div class="card-actions">
                  <button class="btn primary-btn" id="refreshHandoverBtn">
                    <i class="fa-solid fa-arrows-rotate"></i> 새로고침
                  </button>
                  <button class="btn primary-btn" id="newHandoverBtn">
                    <i class="fa-solid fa-plus"></i> 인수인계 등록
                  </button>
                </div>
              </div>
              
              <!-- 인수인계 테이블 -->
              <div class="table-container">
                <table class="data-table" id="handoverTable">
                  <thead>
                    <tr>
                      <th>제목</th>
                      <th>카테고리</th>
                      <th>우선순위</th>
                      <th>작성자</th>
                      <th>작성일시</th>

                    </tr>
                  </thead>
                  <tbody id="handoverTableBody">
                    <tr>
                      <td colspan="6" class="empty-table">데이터를 불러오는 중...</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>
  </div>
  
  <!-- 모달 컴포넌트들 -->
  <!-- 상태 변경 모달 -->
  <div class="modal" id="statusModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>상태 변경</h3>
        <button class="close-btn" data-modal="statusModal">
          <i class="fa-solid fa-times"></i>
        </button>
      </div>
      <div class="modal-body">
        <form id="statusForm">
          <input type="hidden" id="statusItemId">
          <div class="form-group">
            <label for="currentStatus">현재 상태</label>
            <input type="text" id="currentStatus" class="input-field" readonly>
          </div>
          <div class="form-group">
            <label for="newStatus">새 상태</label>
            <select id="newStatus" class="select-field" required>
              <option value="">선택하세요</option>
              <option value="PENDING">대기</option>
              <option value="IN_PROGRESS">진행</option>
              <option value="COMPLETE">완료</option>
              <option value="ISSUE">이슈</option>
              <option value="CANCEL">취소</option>
            </select>
          </div>
          <div class="form-group">
            <label for="statusRemark">비고</label>
            <textarea id="statusRemark" class="textarea-field" rows="3" placeholder="상태 변경 사유 등을 입력하세요"></textarea>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button class="btn secondary-btn" data-modal="statusModal">취소</button>
        <button class="btn primary-btn" id="saveStatusBtn">저장</button>
      </div>
    </div>
  </div>
  
  <!-- 배차 처리 모달 -->
  <div class="modal" id="assignModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>배차 처리</h3>
        <button class="close-btn" data-modal="assignModal">
          <i class="fa-solid fa-times"></i>
        </button>
      </div>
      <div class="modal-body">
        <p id="selectedCount">0개 항목 선택됨</p>
        <form id="assignForm">
          <div class="form-group">
            <label for="driverSelect">배송기사</label>
            <select id="driverSelect" class="select-field" required>
              <option value="">선택하세요</option>
            </select>
          </div>
          <div class="form-group">
            <label for="driverContact">연락처</label>
            <input type="text" id="driverContact" class="input-field" readonly>
          </div>
          <div class="form-group">
            <label for="vehicleInfo">차량정보</label>
            <input type="text" id="vehicleInfo" class="input-field" readonly>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button class="btn secondary-btn" data-modal="assignModal">취소</button>
        <button class="btn primary-btn" id="saveAssignBtn">배차 완료</button>
      </div>
    </div>
  </div>
  
  <!-- 상세 정보 모달 -->
  <div class="modal" id="detailModal">
    <div class="modal-content modal-lg">
      <div class="modal-header">
        <h3>주문 상세 정보</h3>
        <button class="close-btn" data-modal="detailModal">
          <i class="fa-solid fa-times"></i>
        </button>
      </div>
      <div class="modal-body">
        <div class="detail-card">
          <div class="detail-section">
            <h4>주문 정보</h4>
            <div class="detail-grid">
              <div class="detail-item">
                <p class="detail-label">주문번호</p>
                <p class="detail-value" id="detailOrderNo">-</p>
              </div>
              <div class="detail-item">
                <p class="detail-label">고객</p>
                <p class="detail-value" id="detailCustomer">-</p>
              </div>
              <div class="detail-item">
                <p class="detail-label">유형</p>
                <p class="detail-value" id="detailType">-</p>
              </div>
              <div class="detail-item">
                <p class="detail-label">상태</p>
                <div class="detail-value detail-status-container">
                  <span class="status-badge" id="detailStatus">-</span>
                  <select id="detailNewStatus" class="select-field detail-status-select">
                    <option value="">상태 변경</option>
                    <option value="PENDING">대기</option>
                    <option value="IN_PROGRESS">진행</option>
                    <option value="COMPLETE">완료</option>
                    <option value="ISSUE">이슈</option>
                    <option value="CANCEL">취소</option>
                  </select>
                </div>
              </div>
              <div class="detail-item">
                <p class="detail-label">부서</p>
                <p class="detail-value" id="detailDepartment">-</p>
              </div>
              <div class="detail-item">
                <p class="detail-label">창고</p>
                <p class="detail-value" id="detailWarehouse">-</p>
              </div>
            </div>
          </div>
          
          <div class="detail-section">
            <h4>배송 정보</h4>
            <div class="detail-grid">
              <div class="detail-item">
                <p class="detail-label">ETA</p>
                <p class="detail-value" id="detailEta">-</p>
              </div>
              <div class="detail-item">
                <p class="detail-label">배송기사</p>
                <p class="detail-value" id="detailDriver">-</p>
              </div>
              <div class="detail-item">
                <p class="detail-label">연락처</p>
                <p class="detail-value" id="detailContact">-</p>
              </div>
              <div class="detail-item detail-wide">
                <p class="detail-label">주소</p>
                <p class="detail-value" id="detailAddress">-</p>
              </div>
              <div class="detail-item">
                <p class="detail-label">우편번호</p>
                <p class="detail-value" id="detailPostalCode">-</p>
              </div>
            </div>
          </div>
          
          <div class="detail-section">
            <h4>추가 정보</h4>
            <div class="detail-grid">
              <div class="detail-item">
                <p class="detail-label">등록일시</p>
                <p class="detail-value" id="detailCreatedAt">-</p>
              </div>
              <div class="detail-item">
                <p class="detail-label">수정일시</p>
                <p class="detail-value" id="detailUpdatedAt">-</p>
              </div>
              <div class="detail-item detail-wide">
                <p class="detail-label">비고</p>
                <p class="detail-value" id="detailRemark">-</p>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn secondary-btn" data-modal="detailModal">닫기</button>
        <button class="btn primary-btn" id="saveDetailStatusBtn">상태 저장</button>
      </div>
    </div>
  </div>
  
  <!-- 인수인계 상세 모달 -->
  <div class="modal" id="handoverDetailModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>인수인계 상세</h3>
        <button class="close-btn" data-modal="handoverDetailModal">
          <i class="fa-solid fa-times"></i>
        </button>
      </div>
      <div class="modal-body">
        <div class="handover-detail">
          <h4 id="handoverDetailTitle">제목</h4>
          <div class="handover-meta">
            <span class="category-badge" id="handoverDetailCategory">카테고리</span>
            <span class="priority-badge" id="handoverDetailPriority">우선순위</span>
            <span class="handover-author" id="handoverDetailAuthor">작성자</span>
            <span class="handover-date" id="handoverDetailDate">작성일시</span>
          </div>
          <div class="handover-content" id="handoverDetailContent">
            내용이 표시됩니다.
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn secondary-btn" data-modal="handoverDetailModal">닫기</button>
      </div>
    </div>
  </div>
  
  <!-- 신규 등록 모달 -->
  <div class="modal" id="newOrderModal">
    <div class="modal-content modal-lg">
      <div class="modal-header">
        <h3>신규 주문 등록</h3>
        <button class="close-btn" data-modal="newOrderModal">
          <i class="fa-solid fa-times"></i>
        </button>
      </div>
      <div class="modal-body">
        <form id="newOrderForm">
          <div class="form-row">
            <div class="form-group">
              <label for="newOrderNo">주문번호</label>
              <input type="text" id="newOrderNo" class="input-field" required>
            </div>
            <div class="form-group">
              <label for="newCustomer">고객</label>
              <input type="text" id="newCustomer" class="input-field" required>
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label for="newType">유형</label>
              <select id="newType" class="select-field" required>
                <option value="DELIVERY">배송</option>
                <option value="PICKUP">회수</option>
              </select>
            </div>
            <div class="form-group">
              <label for="newDepartment">부서</label>
              <select id="newDepartment" class="select-field" required>
                <option value="">선택하세요</option>
              </select>
            </div>
            <div class="form-group">
              <label for="newWarehouse">창고</label>
              <select id="newWarehouse" class="select-field" required>
                <option value="">선택하세요</option>
              </select>
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label for="newEta">ETA</label>
              <input type="datetime-local" id="newEta" class="input-field" required>
            </div>
            <div class="form-group">
              <label for="newStatus">상태</label>
              <select id="newStatus" class="select-field" required>
                <option value="PENDING">대기</option>
                <option value="IN_PROGRESS">진행</option>
                <option value="COMPLETE">완료</option>
                <option value="ISSUE">이슈</option>
                <option value="CANCEL">취소</option>
              </select>
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group form-group-wide">
              <label for="newAddress">주소</label>
              <input type="text" id="newAddress" class="input-field" required>
            </div>
            <div class="form-group">
              <label for="newPostalCode">우편번호</label>
              <input type="text" id="newPostalCode" class="input-field" required>
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group form-group-wide">
              <label for="newRemark">비고</label>
              <textarea id="newRemark" class="textarea-field" rows="3"></textarea>
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button class="btn secondary-btn" data-modal="newOrderModal">취소</button>
        <button class="btn primary-btn" id="saveNewOrderBtn">등록</button>
      </div>
    </div>
  </div>
  
  <!-- 인수인계 등록 모달 -->
  <div class="modal" id="newHandoverModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>인수인계 등록</h3>
        <button class="close-btn" data-modal="newHandoverModal">
          <i class="fa-solid fa-times"></i>
        </button>
      </div>
      <div class="modal-body">
        <form id="newHandoverForm">
          <div class="form-group">
            <label for="handoverTitle">제목</label>
            <input type="text" id="handoverTitle" class="input-field" required>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label for="handoverCategory">카테고리</label>
              <select id="handoverCategory" class="select-field" required>
                <option value="">선택하세요</option>
                <option value="배송">배송</option>
                <option value="야간근무">야간근무</option>
                <option value="안전">안전</option>
                <option value="일반">일반</option>
              </select>
            </div>
            <div class="form-group">
              <label for="handoverPriority">우선순위</label>
              <select id="handoverPriority" class="select-field" required>
                <option value="LOW">낮음</option>
                <option value="MEDIUM" selected>중간</option>
                <option value="HIGH">높음</option>
                <option value="URGENT">긴급</option>
              </select>
            </div>
          </div>
          
          <div class="form-group">
            <label for="handoverContent">내용</label>
            <textarea id="handoverContent" class="textarea-field" rows="6" required></textarea>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button class="btn secondary-btn" data-modal="newHandoverModal">취소</button>
        <button class="btn primary-btn" id="saveNewHandoverBtn">등록</button>
      </div>
    </div>
  </div>
  
  <!-- 메시지 팝업 컴포넌트 -->
  <div id="messagePopup" class="message-popup">
    <div class="message-content">
      <i class="fa-solid message-icon"></i>
      <span class="message-text"></span>
    </div>
  </div>
  
  <!-- Chart.js 라이브러리 추가 -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
  
  <!-- JavaScript 파일 - 순서 중요함 -->
  <script src="js/utils.js"></script>
  <script src="js/data.js"></script>
  <script src="js/dashboard.js"></script>
  <script src="js/visualization.js"></script>
  <script src="js/handover.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
