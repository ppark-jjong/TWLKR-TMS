{% extends "base.html" %}

{% block title %}{% if handover %}인수인계 수정{% else %}인수인계 작성{% endif %} - Teckwah TMS{% endblock %}

{% block page_css %}
<link rel="stylesheet" href="{{ url_for('static', path='css/handover.css') }}">
{% endblock %}

{% block content %}
<div class="handover-form-page">
    <div class="page-header">
        <h1 class="page-title">
            <i class="fa-solid {% if handover %}fa-edit{% else %}fa-plus{% endif %}"></i>
            {% if handover %}인수인계 수정{% else %}신규 인수인계 작성{% endif %}
        </h1>
        <div class="header-actions">
            <a href="{% if handover %}/handover/{{ handover.handover_id }}{% else %}/handover{% endif %}" class="btn secondary-btn">
                <i class="fa-solid fa-times"></i>
                취소
            </a>
        </div>
    </div>
    
    <div class="main-card">
        <form id="handoverForm" action="{% if handover %}/handover/{{ handover.handover_id }}{% else %}/handover{% endif %}" method="POST" class="handover-form">
            {% if handover %}
            <input type="hidden" name="_method" value="PUT">
            <input type="hidden" name="handover_id" value="{{ handover.handover_id }}">
            {% endif %}
            
            <div class="form-section">
                <div class="form-row">
                    <div class="form-group">
                        <label for="title">제목 <span class="required">*</span></label>
                        <input type="text" id="title" name="title" class="input-field" placeholder="제목을 입력하세요" required value="{% if handover %}{{ handover.title }}{% endif %}">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="type">유형 <span class="required">*</span></label>
                        <select id="type" name="type" class="select-field" required>
                            <option value="NOTICE" {% if handover and handover.type == 'NOTICE' %}selected{% endif %} {% if user.user_role != 'ADMIN' %}disabled{% endif %}>공지사항</option>
                            <option value="HANDOVER" {% if not handover or handover.type == 'HANDOVER' %}selected{% endif %}>인수인계</option>
                        </select>
                        {% if user.user_role != 'ADMIN' %}
                        <small class="help-text">공지사항은 관리자만 작성할 수 있습니다.</small>
                        {% endif %}
                    </div>
                    <div class="form-group">
                        <label for="priority">우선순위 <span class="required">*</span></label>
                        <select id="priority" name="priority" class="select-field" required>
                            <option value="LOW" {% if handover and handover.priority == 'LOW' %}selected{% endif %}>낮음</option>
                            <option value="MEDIUM" {% if not handover or handover.priority == 'MEDIUM' %}selected{% endif %}>중간</option>
                            <option value="HIGH" {% if handover and handover.priority == 'HIGH' %}selected{% endif %}>높음</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="content">내용 <span class="required">*</span></label>
                    <textarea id="content" name="content" class="text-area" rows="12" required placeholder="내용을 입력하세요">{% if handover %}{{ handover.content }}{% endif %}</textarea>
                </div>
            </div>
            
            <div class="form-actions">
                <a href="{% if handover %}/handover/{{ handover.handover_id }}{% else %}/handover{% endif %}" class="btn secondary-btn">취소</a>
                <button type="submit" class="btn primary-btn">
                    <i class="fa-solid fa-check"></i> 
                    {% if handover %}저장하기{% else %}등록하기{% endif %}
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}

{% block page_js %}
<script src="{{ url_for('static', path='js/handover_form.js') }}"></script>
{% endblock %}
