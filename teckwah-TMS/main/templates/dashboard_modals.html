<!-- 모달 템플릿 포함 -->
{% include "modals/order_detail_modal.html" %}
{% include "modals/create_order_modal.html" %}
{% include "modals/delete_confirm_modal.html" %}

<!-- 공통 모달 컨테이너 (일반 알림 등에 사용) -->
<div class="modal" id="commonModal">
  <div class="modal-dialog" id="modalDialog">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title" id="modalTitle">모달 제목</h2>
        <button type="button" class="close-btn" id="closeModalBtn">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="modal-body" id="modalBody">
        <!-- 모달 내용이 동적으로 채워집니다 -->
        <div class="loading-spinner" id="modalSpinner">
          <div class="spinner-container">
            <div class="spinner"></div>
            <div class="spinner-text">로딩 중...</div>
          </div>
        </div>
      </div>
      <div class="modal-footer" id="modalFooter">
        <!-- 버튼들이 동적으로 추가됩니다 -->
      </div>
    </div>
  </div>
</div>

<script>
/**
 * 모달 초기화 스크립트
 */
(function() {
  console.log('[모달 관리자] 사용 중인 모달: 주문 상세, 신규 등록, 삭제 확인');

  // 모달 유틸 로드 체크
  document.addEventListener('DOMContentLoaded', function() {
    if (!window.ModalUtils) {
      console.error('[모달 관리자] 모달 유틸리티 모듈이 아직 로드되지 않았습니다.');
      return;
    }
    
    console.log('[모달 관리자] 모달 유틸리티 모듈 로드 확인 완료');
    
    // 행 클릭 이벤트 등록
    document.querySelectorAll('.clickable-row').forEach(row => {
      row.addEventListener('click', function() {
        const orderId = this.dataset.id;
        if (orderId && window.orderDetailModal) {
          console.log(`[모달 관리자] 주문 ID ${orderId} 행 클릭됨`);
          window.ModalUtils.saveStorage('currentOrderId', orderId, { useSession: true });
          window.orderDetailModal.showOrderDetail(orderId);
        }
      });
    });
  });
})();
</script>
