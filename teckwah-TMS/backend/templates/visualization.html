{% extends "layout.html" %} {% block title %}데이터 시각화 - TeckWahKRTMS{%
endblock %} {% block extra_css %}
<link rel="stylesheet" href="/static/css/visualization.css" />
{% endblock %} {% block content %}
<div class="dashboard-container">
  <header class="dashboard-header">
    <div class="header-left">
      <img src="/static/images/logo.png" alt="Logo" class="header-logo" />
      <h1 class="header-title">배송 관제 시스템</h1>
    </div>
    <div class="header-right">
      <span class="user-info"
        >{{ user.user_department }} | {{ user.user_id }} ({{ '관리자' if
        user.user_role == 'ADMIN' else '일반사용자' }})</span
      >
      <button class="logout-button" onclick="logout()">로그아웃</button>
    </div>
  </header>

  <nav class="dashboard-nav">
    <ul class="nav-menu">
      <li class="nav-item"><a href="/dashboard">대시보드</a></li>
      <li class="nav-item"><a href="/handover">인수인계</a></li>
      {% if user.user_role == 'ADMIN' %}
      <li class="nav-item active">
        <a href="/visualization">데이터 시각화</a>
      </li>
      <li class="nav-item"><a href="/users">사용자 관리</a></li>
      {% endif %}
    </ul>
  </nav>

  <main class="dashboard-content">
    <div class="visualization-container">
      <section class="visualization-header">
        <h2 class="section-title">데이터 시각화</h2>
        <div class="date-selector">
          <button
            class="date-button"
            data-period="day"
            onclick="changePeriod('day')"
          >
            일별
          </button>
          <button
            class="date-button"
            data-period="week"
            onclick="changePeriod('week')"
          >
            주별
          </button>
          <button
            class="date-button active"
            data-period="month"
            onclick="changePeriod('month')"
          >
            월별
          </button>
          <button
            class="date-button"
            data-period="year"
            onclick="changePeriod('year')"
          >
            연별
          </button>
        </div>
      </section>

      <div class="visualization-grid">
        <!-- 배송 현황 개요 카드 -->
        <section class="visualization-card summary-card">
          <h3 class="card-title">배송 현황 개요</h3>
          <div class="summary-content">
            <div class="summary-item">
              <div class="summary-value">
                {{ summary.total_orders|default(0) }}
              </div>
              <div class="summary-label">총 주문</div>
            </div>
            <div class="summary-item">
              <div class="summary-value">
                {{ summary.completed_orders|default(0) }}
              </div>
              <div class="summary-label">배송 완료</div>
            </div>
            <div class="summary-item">
              <div class="summary-value">
                {{ summary.in_progress_orders|default(0) }}
              </div>
              <div class="summary-label">배송 중</div>
            </div>
            <div class="summary-item">
              <div class="summary-value">
                {{ summary.pending_orders|default(0) }}
              </div>
              <div class="summary-label">배차 대기</div>
            </div>
          </div>
        </section>

        <!-- 일별 배송량 추이 차트 -->
        <section class="visualization-card chart-card">
          <h3 class="card-title">일별 배송량 추이</h3>
          <div class="chart-container" id="dailyDeliveryChart">
            <canvas id="dailyDeliveryCanvas"></canvas>
          </div>
        </section>

        <!-- 상태별 주문 비율 차트 -->
        <section class="visualization-card chart-card">
          <h3 class="card-title">상태별 주문 비율</h3>
          <div class="chart-container" id="statusRatioChart">
            <canvas id="statusRatioCanvas"></canvas>
          </div>
        </section>

        <!-- 배송 지역별 분포 차트 -->
        <section class="visualization-card chart-card">
          <h3 class="card-title">배송 지역별 분포</h3>
          <div class="chart-container" id="regionDistributionChart">
            <canvas id="regionDistributionCanvas"></canvas>
          </div>
        </section>

        <!-- 시간대별 주문 패턴 -->
        <section class="visualization-card chart-card">
          <h3 class="card-title">시간대별 주문 패턴</h3>
          <div class="chart-container" id="hourlyPatternChart">
            <canvas id="hourlyPatternCanvas"></canvas>
          </div>
        </section>

        <!-- 기사별 배송 실적 -->
        <section class="visualization-card chart-card">
          <h3 class="card-title">기사별 배송 실적</h3>
          <div class="chart-container" id="driverPerformanceChart">
            <canvas id="driverPerformanceCanvas"></canvas>
          </div>
        </section>
      </div>
    </div>
  </main>

  <footer class="dashboard-footer">
    <p>© 2025 TeckWahKR Operation Team. All rights reserved.</p>
  </footer>
</div>
{% endblock %} {% block extra_js %}
<!-- Chart.js 라이브러리 추가 -->
<script src="/static/js/chart.min.js"></script>
<script src="/static/js/visualization.js"></script>
{% endblock %}
